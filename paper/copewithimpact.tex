\section{Coping With the Impact}
\label{sec:cope}

Test dependence causes non-trivial repercussions
to downstream testing techniques.
When test dependence arises, testing techniques
should properly handle the potential dependence 
and keep the test execution results consistent.

Consider a test prioritization
or selection algorithm. By design, if its input is a passing test
suite, then its output should be a passing test suite. If the
suite contains a dependent test, then prioritization
or selection can introduce test failures, which violates the
design requirement.


This section presents a family of techniques to cope with
the impact of test dependence on test prioritization, selection,
and parallelization techniques. 
Our techniques enhance the existing techniques to ensure
they produce an order in which each test yields the same
result as in the original test suite.

\subsection{General Algorithm}

\input{dtalgorithms}

\subsubsection{Termination}

We have proved that this algorithm must terminate and each test
in the produced test order must yield the same result as in the original
one.
\todo{proof omitted here}
\todo{Intuition: in the worst case, it simply returns the original test sequence}

\subsection{Enhancing Test Prioritization Techniques}
\label{sec:enhanceprio}

\begin{figure}[t!]
	\textbf{Auxiliary methods}: \\
    prioritize($\mathit{T}$): the target prioritization algorithm to enhance.\\

    \vspace{-3mm}
	depAwareTestPrioritization($\mathit{T}$)\\
	\textbf{Input}: a test suite (i.e., an ordered sequence of
    tests) $\mathit{T}$\\
	\textbf{Output}: a reorder sequence of $\mathit{T}$ in which every test
    yields the same result as in $\mathit{T}$\\
	 \begin{algorithmic}[1]
	 	\vspace{-5mm}
        \STATE $\mathit{T_{prioritized}} \leftarrow$ proritized($\mathit{T}$)
        \RETURN nullifyTestDependence($\mathit{T}$, $\mathit{T_{prioritized}}$)
	\end{algorithmic}
	\vspace{-3mm}
	\caption {
        An dependence aware test prioritization algorithm. When invoking
        the nullifyTestDependence method in Figure~\ref{fig:basealgorithm},
        this algorithm overrides the merge method. See Section~\ref{sec:enhanceprio}
        for details.
	}
	\label{fig:copetestprio}
\end{figure}

See Figure~\ref{fig:copetestprio}.

\subsection{Enhancing Test Selection Techniques}

\begin{figure}[t!]
	\textbf{Auxiliary methods}: \\
    select($\mathit{T}$): the target test selection algorithm to enhance.\\

    \vspace{-3mm}
	depAwareTestSelection($\mathit{T}$)\\
	\textbf{Input}: a test suite (i.e., an ordered sequence of
    tests) $\mathit{T}$\\
	\textbf{Output}: a subsequence of $\mathit{T}$ in which every test
    yields the same result as in $\mathit{T}$\\
	 \begin{algorithmic}[1]
	 	\vspace{-5mm}
        \STATE $\mathit{T_{selected}} \leftarrow$ select($\mathit{T}$)
        \RETURN nullifyTestDependence($\mathit{T}$, $\mathit{T_{selected}}$)
	\end{algorithmic}
	\vspace{-3mm}
	\caption {
        An dependence aware test selection algorithm. 
	}
	\label{fig:copetestsel}
\end{figure}

See Figure~\ref{fig:copetestsel}.

\subsection{Enhancing Test Parallelization Techniques}

\begin{figure}[t!]
	\textbf{Auxiliary methods}: \\
    parallelize($\mathit{T}$): the target test parallelization algorithm to enhance.
    It returns a set of test suites, each of which is scheduled to run
    a different CPU.\\

    \vspace{-3mm}
	depAwareTestParallelization($\mathit{T}$)\\
	\textbf{Input}: a test suite (i.e., an ordered sequence of
    tests) $\mathit{T}$\\
	\textbf{Output}: a set of test suites, each of which 
    is a subsequence of $\mathit{T}$ and every test in it 
    yields the same result as in $\mathit{T}$\\
	 \begin{algorithmic}[1]
	 	\vspace{-5mm}
        \STATE $\mathit{suites} \leftarrow$ parallelize($\mathit{T}$)
        \FOR{\textbf{each} $\mathit{T_{par}}$ in $\mathit{suites}$}
        \STATE \textbf{yield} nullifyTestDependence($\mathit{T}$, $\mathit{T_{par}}$)
        \ENDFOR
	\end{algorithmic}
	\vspace{-3mm}
	\caption {
        An dependence aware test parallelization algorithm. 
	}
	\label{fig:copetestpar}
\end{figure}


%\input{enhance}

See Figure~\ref{fig:copetestpar}.

\subsection{Discussion}

\subsubsection{Tradeoffs in the Enhanced Testing Techniques}

